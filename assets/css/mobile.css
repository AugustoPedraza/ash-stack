/*
 * MOBILE ENHANCEMENTS
 * ====================
 * iOS-optimized styles for PWA.
 * Safe areas, touch targets, native feel.
 */

/* ============================================
   SAFE AREA VARIABLES
   For iOS notch and home indicator
   ============================================ */
:root {
  --safe-area-top: env(safe-area-inset-top, 0px);
  --safe-area-right: env(safe-area-inset-right, 0px);
  --safe-area-bottom: env(safe-area-inset-bottom, 0px);
  --safe-area-left: env(safe-area-inset-left, 0px);

  /* Minimum touch target (Apple HIG) */
  --touch-target: 44px;

  /* iOS keyboard offset */
  --keyboard-offset: 0px;
}

/* ============================================
   PWA VIEWPORT
   ============================================ */
html {
  /* Prevent pull-to-refresh on iOS */
  overscroll-behavior-y: none;

  /* Smooth scrolling */
  scroll-behavior: smooth;

  /* Prevent text size adjustment on orientation change */
  -webkit-text-size-adjust: 100%;
}

body {
  /* Prevent bounce scrolling */
  overscroll-behavior: none;

  /* Safe area padding for full-screen PWA */
  padding-top: var(--safe-area-top);
  padding-bottom: var(--safe-area-bottom);
  padding-left: var(--safe-area-left);
  padding-right: var(--safe-area-right);
}

/* ============================================
   TOUCH OPTIMIZATIONS
   ============================================ */

/* Disable tap highlight on iOS */
* {
  -webkit-tap-highlight-color: transparent;
}

/* Faster touch response */
button,
a,
[role="button"],
input,
select,
textarea {
  touch-action: manipulation;
}

/* Minimum touch target size */
.touch-target {
  min-width: var(--touch-target);
  min-height: var(--touch-target);
}

/* ============================================
   iOS-STYLE SCROLLING
   ============================================ */
.scroll-ios {
  -webkit-overflow-scrolling: touch;
  overscroll-behavior: contain;
}

/* Hide scrollbars but keep functionality */
.scroll-hidden {
  scrollbar-width: none;
  -ms-overflow-style: none;
}
.scroll-hidden::-webkit-scrollbar {
  display: none;
}

/* ============================================
   SAFE AREA UTILITIES
   ============================================ */

/* Top safe area (for headers under notch) */
.safe-top {
  padding-top: var(--safe-area-top);
}

/* Bottom safe area (for tab bars) */
.safe-bottom {
  padding-bottom: max(var(--safe-area-bottom), 1rem);
}

/* All safe areas */
.safe-area {
  padding-top: var(--safe-area-top);
  padding-bottom: var(--safe-area-bottom);
  padding-left: var(--safe-area-left);
  padding-right: var(--safe-area-right);
}

/* Fixed bottom elements (tab bar, FAB) */
.fixed-bottom-safe {
  bottom: 0;
  padding-bottom: max(var(--safe-area-bottom), 1rem);
}

/* ============================================
   MOBILE TYPOGRAPHY
   ============================================ */

/* Prevent text selection on UI elements */
.no-select {
  -webkit-user-select: none;
  user-select: none;
}

/* Allow text selection */
.select-text {
  -webkit-user-select: text;
  user-select: text;
}

/* ============================================
   PULL-TO-REFRESH INDICATOR
   ============================================ */
.pull-indicator {
  position: fixed;
  top: var(--safe-area-top);
  left: 50%;
  transform: translateX(-50%) translateY(-100%);
  transition: transform 0.2s ease-out;
  z-index: 9999;
}

.pull-indicator.visible {
  transform: translateX(-50%) translateY(0);
}

/* ============================================
   SHEET / MODAL BACKDROP
   iOS-style blur
   ============================================ */
.backdrop-blur-ios {
  backdrop-filter: saturate(180%) blur(20px);
  -webkit-backdrop-filter: saturate(180%) blur(20px);
}

/* ============================================
   KEYBOARD AWARE
   Adjust for virtual keyboard
   ============================================ */
@supports (height: 100dvh) {
  .h-screen-dynamic {
    height: 100dvh;
  }

  .min-h-screen-dynamic {
    min-height: 100dvh;
  }
}

/* ============================================
   MOTION PREFERENCES
   Respect reduced motion
   ============================================ */
@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }
}

/* ============================================
   STANDALONE PWA STYLES
   When app is installed
   ============================================ */
@media (display-mode: standalone) {
  /* Hide browser UI elements */
  .hide-standalone {
    display: none;
  }

  /* Show PWA-only elements */
  .show-standalone {
    display: block;
  }

  /* Extra padding for iOS status bar */
  .standalone-header {
    padding-top: calc(var(--safe-area-top) + 0.5rem);
  }
}
